import { WEMA } from '../../src/wema';
import { ohlc } from './data';

describe('Exponentially Weighted Moving Average (EWMA)', () => {
    it('Base test', () => {
        const solvedData = [
            undefined,
            undefined,
            undefined,
            undefined,
            undefined,
            1129.6899999999998,
            1130.0366666666664,
            1131.347222222222,
            1133.1743518518515,
            1136.9136265432096,
            1138.6080221193413,
            1139.5650184327844,
            1136.8091820273203,
            1133.5176516894335,
            1131.403043074528,
            1130.6458692287733,
            1129.8665576906444,
            1129.688798075537,
            1129.123998396281,
            1125.6049986635676,
            1122.7624988863063,
            1118.5404157385885,
            1116.653679782157,
            1119.4863998184642,
            1119.7653331820534,
            1116.9944443183779,
            1113.4937035986482,
            1111.7297529988734,
            1112.1797941657278,
            1109.79982847144,
            1108.7715237262,
            1109.6212697718333,
            1112.3827248098612,
            1117.3522706748843,
            1120.5735588957368,
            1123.8229657464474,
            1125.6024714553728,
            1126.152059546144,
            1126.1517162884534,
            1126.9964302403778,
            1131.4870252003147,
            1137.1075210002623,
            1143.569600833552,
            1148.42633402796,
            1151.4736116899667,
            1152.7946764083056,
        ];
        const local = new WEMA(6);

        ohlc.forEach((tick, idx) => {
            const value = local.nextValue(tick.c);

            expect(value).toBe(solvedData[idx]);
        });
    });
});
